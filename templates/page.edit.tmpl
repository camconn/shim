{{define "editPage"}}
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>SHIM | Editor</title>
		{{template "stylesheets"}}
	</head>
	{{- $Post := .Post -}}
	<body>
		{{template "navbar"}}

		<div id="content" class="content">
			<h1>Edit Post</h1>
			{{- if .Failed -}}
			<div class="notification is-danger">
				{{- .Message | html -}}
			</div>
			{{- end -}}
			<form action="{{- .URL -}}" method="post" class="container is-fluid">
				<noscript>
					<div>
						<style type="text/css">
						/* Workaround for whenever the client doesn't have JS enabled */
						#collapse {
							display: inline !important;
						}
						#toggleButtonDiv {
							display: none !important;
						}
						</style>
					</div>
				</noscript>
				<script type="text/javascript">
				function toggleCollapse() {
					var coll = document.getElementById("collapse");
					if (coll === null) { return; }
					dis = coll.style.display;
					if (dis === "inline") {
						coll.style.display = "none";
						console.log("now hidden")
					} else {
						coll.style.display = "inline";
						console.log("now visible")
					}
				}
				</script>
				<div id="toggleButtonDiv">
					<p><a href="#" onclick="toggleCollapse()"><span class="toggle" onclick="">+</span>Click to show post properties.</a></p>
					<br />
				</div>
				<div id="collapse">
					{{- range $opt := $.Config -}}
					<div class="columns">
						{{- if gt (len $opt.Description) 0 -}}
							<div class="column is-third">
								<p><code>{{- $opt.Name | html -}}</code>: {{ $opt.Description | html -}}</p>
							</div>
						{{- else -}}
							<div class="column is-quarter">
								<p class="title">{{- $opt.Name | html -}}</p>
							</div>
						{{- end -}}
						<div class="column">
						{{- if eq $opt.Name "published" -}}
							<input class="input" type="text" name="{{- $opt.Name | html -}}" value="{{- $opt.Value | html -}}" placeholder="25 Dec 2000 @ 23:59">
						{{- else if eq $opt.Type "string" -}}
							<input class="input" type="text" name="{{- $opt.Name | html -}}" value="{{- $opt.Value | html -}}">
						{{- else if eq $opt.Type "taxonomy" -}}
							<input class="input" type="text" name='{{- printf "taxonomy.%s" $opt.Name | html -}}' value="{{- $opt.Value | html -}}">
						{{- else -}}
							Unknown object: <code>{{ $opt | html -}}</code>
						{{- end -}}
						</div>
					</div>
					{{- end -}}
					<p class="is-text-right"><i>Taxonomies are a list of words separated by commas. All spaces are removed.</i></p>
					<hr>
				</div>
				<script type="text/javascript">document.getElementById("collapse").style.display = "none";</script>
				<input class="input" type="text" name="title" value="{{- $Post.Title | html -}}" placeholder="Your Post's Title">
				<textarea class="textarea monospace" name="articleSrc" style="min-height:320px" placeholder="Write some stuff here...">{{- printf "%s" $Post.GetBody | html -}}</textarea>
				{{ if $Post.Draft }}
				<label class="checkbox"><input type="checkbox" name="doPublish"> Publish Post?</label>
				{{ else }}
				<label class="checkbox"><input type="checkbox" name="doPublish" checked> Republish Post?</label>
				{{ end }}
				<div class="columns is-mobile">
					<div class="column is-half">
						<a class="button is-info is-outlined" href="/preview/{{- $Post.PreviewPath -}}">Preview</a>
					</div>
					<div class="column is-right is-text-right">
						<input class="button is-primary" type="submit" value="Save">
					</div>
				</div>
			</form>
		</div>

		{{template "footer"}}
	</body>
</html>
{{end}}
