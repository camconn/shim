{{define "editPage"}}
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>SHIM | Editor</title>
		{{template "stylesheets"}}
	</head>
	{{- $Post := .Post -}}
	<body>
		{{template "navbar"}}

		<div id="content" class="content">
			<form action="{{- .URL -}}" method="post">
				<noscript>
					<div>
						<style type="text/css">
						/* Workaround for whenever the client doesn't have JS enabled */
						#collapse {
							display: inline !important;
						}
						#toggleButtonDiv {
							display: none !important;
						}
						</style>
					</div>
				</noscript>
				<script type="text/javascript">
				function toggleCollapse() {
					coll = document.getElementById("collapse");
					if (coll === null) { return; }
					dis = coll.style.display;
					if (dis === "inline") {
						coll.style.display = "none";
						console.log("now hidden")
					} else {
						coll.style.display = "inline";
						console.log("now visible")
					}
				}
				</script>
				<div id="toggleButtonDiv">
					<p><a href="#" onclick="toggleCollapse()"><span class="toggle" onclick="">+</span>Click to show post properties.</a></p>
					<br />
				</div>
				<div id="collapse">
					{{- range $opt := $.Config -}}
					<div class="columns">
						<div class="column is-third">
							<p><code>{{ $opt.Name | html -}}</code>: {{ $opt.Description | html -}}</p>
						</div>
						<div class="column">
						{{- if eq $opt.Type "string" -}}
							<input type="text" name="{{- $opt.Name | html -}}" value="{{- $opt.Value | html -}}">
						{{- else -}}
							Unknown object: <code>{{ $opt | html -}}</code>
						{{- end -}}
						</div>
					</div>
					{{- end -}}
					<hr>
				</div>
				<script type="text/javascript">document.getElementById("collapse").style.display = "none";</script>
				<input class="input" type="text" name="title" value="{{ $Post.Title }}">
				<textarea class="textarea monospace" name="articleSrc" style="min-height:320px">{{- printf "%s" $Post.GetBody | html -}}</textarea>
				{{ if $Post.Draft }}
				<label class="checkbox"><input type="checkbox" name="doPublish"> Publish Post?</label>
				{{ else }}
				<label class="checkbox"><input type="checkbox" name="doPublish" checked> Republish Post?</label>
				{{ end }}
				<div class="columns is-mobile">
					<div class="column is-quarter">
						<a class="button is-info is-outlined" href="/preview/{{- $Post.RelPath -}}">Preview</a>
					</div>
					<div class="column is-half">
					</div>
					<div class="column is-right is-text-right">
						<input class="button is-primary" type="submit" value="Save">
					</div>
				</div>
			</form>
		</div>

		{{template "footer"}}
	</body>
</html>
{{end}}
